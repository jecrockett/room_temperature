<%= javascript_include_tag "https://www.google.com/jsapi", "chartkick" %>
<div class="dashboard-wrapper">
  <h2>Sentiment Dashboard</h2>



  <div class="filters">
    <%= form_tag(dashboard_path) do %>
      <div class="field">
        <div class="input-field">
          <%= select_tag(:channel, options_from_collection_for_select(Channel.all, "id", "name"), include_blank: true) %>
          <%= label_tag 'channel', 'Select a Channel (required):' %>
        </div>
      </div>
      <div class="field">
        <div class="input-field">
          <%= select_tag(:user, options_from_collection_for_select(User.where.not(nickname: nil), "id", "nickname"), include_blank: true) %>
          <%= label_tag 'user', 'Filter by User (optional):' %>
        </div>
      </div>
      <div class="field">
        <div class="input-field">
          <%= select_tag(:range, options_for_select(["Weekly", "Daily"])) %>
          <%= label_tag 'user', 'Choose a time range (required):' %>
        </div>
      </div>
      <div class="field">
        <%= submit_tag "F I L T E R", class: "submit-btn" %>
      </div>
    <% end %>
  </div>

  <div id="chart" class="container">
    <h4 class="center"><%= @chart_title %></h4>
    <br>
    <% if @user_data %>
      <%= scatter_chart [
        {name: "Channel", data: @channel_data},
        {name: "Selected User", data: @user_data}],
        colors: ['blue', 'red'], min: 0, max: 1, width: "100%", height: "400px" %>
    <% else %>
      <%= scatter_chart @channel_data, min: 0, max: 1, width: "100%", height: "400px" %>
    <% end %>

  </div>
</div>
